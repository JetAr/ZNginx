<HTML>
<HEAD>
<TITLE>
Phttpd: FDSTDIO
</TITLE>
</HEAD>
<BODY>
<H2 ALIGN=CENTER>
The FDSTDIO subsystem
</H2>

<B>Fdstdio</B> is a set of cover routines to implement a STDIO-like
subsystem, but without some of it's annoying limitations (like only
working for the first 64 file descriptors, and not being able to use
a FILE for both input and output concurrently).

<H3>Functions:</H3>

<DL>
<DT><B>int fd_putc(int c, int fd)</B>
<DD>Writes the character <EM>s</EM> to the file descriptor <EM>fd</EM>.

<P><DT><B>int fd_puts(char *s, int fd)</B>
<DD>Writes the string <EM>s</EM> to the file descriptor <EM>fd</EM>.

<P><DT><B>int fd_write(int fd, char *buf, int len)</B>
<DD>Writes the buffer <EM>buf</EM>, of size <EM>len</EM> to the file
	descriptor <EM>fd</EM>.


<P><DT><B>int fd_getc(int fd)</B>
<DD>Read one character from the file descriptor <EM>fd</EM>.

<P><DT><B>char *fd_gets(char *buf, int size, int fd)</B>
<DD>Reads a string, terminated by a newline, from a descriptor.

<P><DT><B>int fd_read(int fd, char *buf, int len)</B>
<DD>Read a specific number of bytes from the descriptor.



<P><DT><B>void fd_reopen(int fd, int how, int type)</B>
<DD>Associate an <B>fdstdio</B> buffer with a file descriptor.

<P><DT><B>int fd_open(const char *file, int how, ...)</B>
<DD>Open a file and associate it with a <B>fdstdio</B> buffer.

<P><DT><B>int fd_connect(struct sockaddr *sap, int len)</B>
<DD>Open a new socket connection, and associate it with a <B>fdstdio</B>
	buffer.

<P><DT><B>int fd_mksockaddr_in(const char *host, char *service, struct sockaddr_in *sin)</B>
<DD>Fill in a <B>sockaddr</B> structure with the host address and port number
	which is associated with the host and service strings.

<P><DT><B>int fd_sconnect(const char *host, char *service)</B>
<DD>Convenience function combining the two functions above.


<P><DT><B>int fd_close(int fd)</B>
<DD>Close a file descriptor (and release the allocated buffers).

<P><DT><B>int fd_shutdown(int fd, int how)</B>
<DD>Shutdown a file descriptor for further reading, writing or both.


<P><DT><B>int fd_foreach(int (*fcnp)(int fd, struct fd_buffer *bp, void *misc), void *misc)</B>
<DD>Loop over all open file descriptors.


<P><DT><B>int fd_avail(int fd)</B>
<DD>Return the number of bytes available to be read on a descriptor.

<P><DT><B>int fd_wait(int fd)</B>
<DD>Wait for some bytes to become available on the descriptor.

<P><DT><B>int fd_ungetc(int c, int fd)</B>
<DD>"unget" a previously read character from a file descriptor.


<P><DT><B>int fd_flush(int fd)</B>
<DD>Force all written characters in the buffers to be transmitted/written.




<P><DT><B>int fd_puti(int val, int fd)</B>
<DD>Writes the integer value as a string to the descriptor.

<P><DT><B>int fd_puts2nl(const char *s1, const char *s2, int fd)</B>
<DD>Writes two strings and a terminating newline to the descriptor.

<P><DT><B>int fd_putsinl(const char *s1, int val, int fd)</B>
<DD>Writes a string, an integer value and a newline to the descriptor.



<P><DT><B>int fd_vprintf(int fd, const char *format, va_list ap)</B>
<DD>Formatted printing. See the printf man page.

<P><DT><B>int fd_printf(int fd, const char *format, ....)</B>
<DD>Formatted printing. See the printf man page.



<P><DT><B>int fd_written(int fd)</B>
<DD>Returns the number of bytes written since the descriptor was
opened/associated with a <B>fdstdio</B> buffer.


<P><DT><B>int fd_relay(int fd1, int fd2, int bidir)</B>
<DD>Uni- or Bidirectionally relay data between two descriptors.

</DL>

</BODY>
</HTML>

