

#include "main.h"




////////////////////////////////////////////////////////////////////////////////////////////////
//// Name: CFog()
//// Desc: default construct
////////////////////////////////////////////////////////////////////////////////////////////////
CFog::CFog()
{
	startz = 1.0f;
	endz = 5.0f;
	density = DEFAULT_DENSITY;
	clr = BLACK;
	mode = FOG_EXP2;
}


////////////////////////////////////////////////////////////////////////////////////////////////
//// Name: CFog()
//// Desc:
////////////////////////////////////////////////////////////////////////////////////////////////
CFog::CFog( FOG_MODE fog_mode, rgb color, float start, float end, float dens )
{
	Initialize( fog_mode, color, start, end, dens );
}


////////////////////////////////////////////////////////////////////////////////////////////////
//// Name: Initialize()
//// Desc: init fog
////////////////////////////////////////////////////////////////////////////////////////////////
void CFog::Initialize( FOG_MODE fog_mode, rgb color, float start, float end, float dens )
{
	mode = fog_mode;
	clr = color;
	startz = start;
	endz = end;
	density = dens;
}


////////////////////////////////////////////////////////////////////////////////////////////////
//// Name: setEnable()
//// Desc: enable fog
////////////////////////////////////////////////////////////////////////////////////////////////
void CFog::setEnable()
{

	// set fog mode
	if ( mode == FOG_EXP )
		glFogi( GL_FOG_MODE, GL_EXP );
	else if ( mode == FOG_EXP2 )
		glFogi( GL_FOG_MODE, GL_EXP2 );
	else
		glFogi( GL_FOG_MODE, GL_LINEAR );

	// set fog color
	float fc[] = { clr.r, clr.g, clr.b, 1.0f };
	glFogfv( GL_FOG_COLOR, fc );

	// near and far plane
	glFogf( GL_FOG_START, startz );
	glFogf( GL_FOG_END, endz );

	// density
	glFogf( GL_FOG_DENSITY, density );

	// calcs performance
	glHint( GL_FOG, GL_FASTEST ); // GL_DONT_CARE, GL_NICEST, GL_FASTEST

	// finally, enable fog
	glEnable( GL_FOG );
}


////////////////////////////////////////////////////////////////////////////////////////////////
//// Name: setDisable()
//// Desc: disable fog
////////////////////////////////////////////////////////////////////////////////////////////////
void CFog::setDisable()
{
	glDisable( GL_FOG );
}


////////////////////////////////////////////////////////////////////////////////////////////////
//// Name: setLOD()
//// Desc: sets LOD fog for slightly better performance
////////////////////////////////////////////////////////////////////////////////////////////////
void CFog::setLOD( bool bLOD )
{
	// simply change fog calculations
	if ( bLOD )
		glHint( GL_FOG, GL_FASTEST );
	else
		glHint( GL_FOG, GL_NICEST );
}

